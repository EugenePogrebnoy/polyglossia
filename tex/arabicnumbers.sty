\ProvidesPackage{arabicnumbers}
        [2010/03/04 v0.1 %
         Formatting of Arabic and Farsi digits and of Arabic abjad numerals]

\def\arabicdigits#1{\expandafter\@arabic@digits #1@}
\def\@arabic@digits#1{%
  \ifx @#1% then terminate
  \else
    \ifcat0#1%
      \ifcase #1٠\or ١\or ٢\or ٣\or ٤\or٥\or ٦\or ٧\or ٨\or ٩\fi
    \else #1%
    \fi
    \expandafter\@arabic@digits
 \fi
}

\def\farsidigits#1{\expandafter\@farsi@digits #1@}
\def\@farsi@digits#1{%
  \ifx @#1% then terminate
  \else
    \ifcat0#1%
      \ifcase #1 ۰\or ۱\or ۲\or ۳\or ۴\or ۵\or ۶\or ۷\or ۸\or ۹\fi
    \else
      #1%
    \fi
    \expandafter\@farsi@digits
  \fi
}

\def\abjad#1{%
\ifnum#1>1999\xpg@ill@value{#1}{abjad numeral}%
\else
\ifnum#1<\z@\space\xpg@ill@value{#1}{abjad numeral}%
  \else
    \ifnum#1<10\expandafter\abj@num@i@iso\number#1%
    \else
      \ifnum#1<100\expandafter\abj@num@ii\number#1%
      \else
        \ifnum#1<\@m\expandafter\abj@num@iii\number#1%
        \else
          \ifnum#1<\@M\expandafter\abj@num@iv\number#1%since #1<2000, we must have 1000
          \fi
        \fi
      \fi
    \fi
  \fi
\fi
}
\def\abjad@zero{}
\def\abjad@three{ج\ifabjad@jim@notail\char"200D\fi}
\def\abj@num@i@iso#1{%
  \ifcase#1\or ا\or ب\or\abjad@three\or د%
           \or ه\char"200D\or و\or ز\or ح\or ط\fi%
  \ifnum#1=\z@\abjad@zero\fi}
\def\abj@num@i#1{%
  \ifcase#1\or ا\or ب\or\abjad@three\or د%
           \or ه\or و\or ز\or ح\or ط\fi%
  \ifnum#1=\z@\abjad@zero\fi}
\def\abj@num@ii#1{%
  \ifcase#1\or ي\or ك\or ل\or م\or ن%
           \or س\or ع\or ف\or ص\fi% 
  \ifnum#1=\z@\fi\abj@num@i}
\def\abj@num@iii#1{%
  \ifcase#1\or ق\or ر\or ش\or ت\or ث%
            \or خ\or ذ\or ض\or ظ\fi%
  \ifnum#1=\z@\fi\abj@num@ii}
\def\abj@num@iv#1{%
  \ifcase#1\or غ\fi
  \ifnum#1=\z@\fi\abj@num@iii}
\endinput
